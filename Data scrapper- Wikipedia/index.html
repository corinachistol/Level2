
<!--  Video 505

    WEB SCRAPPER: o aplicatie ,componenta care poate scana date de pe site-uri straine
        * AJAX
        * DOM
        * ARRAY
        * OOP



  ------------BROWSER------------               HTTP
                                |      
         app(js / front) ------- > Request-------- > server
                        <--------  Response ------<
                                |    text
                                v
                            dom parser
                                |
                                v
                            dom structure
                                |
                                v
                                data
|                                |
---------------------------------



 -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Scrapper</title>
    <style>
        *{
            margin: auto;
            padding: 0;
        }
        body{
            background-color: #235;
            color: white;
       
        }
        h1{
            text-align: center;
        }
        #output{
            margin: auto;
            width: 50%;
            //border: 1px solid red;
        }
        .table{
           
            
        }
    </style>
</head>
<body>

    <h1>List of programming languages for J letter according to Wikipedia</h1>
    <div id="output"></div>

    <script>

        const outputElement = document.querySelector('#output')

        const URL = "https://en.wikipedia.org/wiki/List_of_programming_languages"
        //let languages=[]

        //using ajax to communciate with wiki server in background
        function loadPage() {
            const xhr = new XMLHttpRequest()

            xhr.open("GET", URL)

            xhr.onload = () => {
                //parse the doc
                let html    = xhr.responseText   // string 
                let parser =  new DOMParser()
                let htmlDoc = parser.parseFromString(html, "text/html")  //DOm structure

                //traverse the dom
                // & scrape
                let languages = []
                let divs = htmlDoc.querySelectorAll('.div-col')
                let div = divs[9]
                let lis = div.firstElementChild.children
                //console.log(lis)
                for(let i=0; i< lis.length; i++) {
                    languages.push( lis[i].firstElementChild.innerText )  
                }

                // lis = [...lis].forEach( (li) =>{
                //     languages.push(li.firstElementChild.innerText)
                // } )

                // Array.from(lis).forEach( (li) =>{
                //     languages.push(li.firstElementChild.innerText)
                // } )


                //HW1: render the gathered info into a html table intr-o coloana
                //using DOM OOP aproach

                render(languages, outputElement)

                
                //console.log(htmlDoc) // este un document in memorie care s-a incarcat de pe wikipedia
                console.log(languages)
                
                return languages
            }

            xhr.send()
        }

        loadPage()
        
        

       

        const render = (data, parent) =>{
            const table = document.createElement('table')
            const tbody = document.createElement('tbody')

            for(let i=0; i<data.length; i++){ 
               const row = document.createElement("tr")

               for(let j=0; j<1; j++){
                const cell = document.createElement("td")
                cell.innerHTML = data[i]
                
                row.appendChild(cell)
            }

               tbody.appendChild(row)
            }

            table.appendChild(tbody)

            parent.appendChild(table)
            table.setAttribute('border', 2)
          
        }

  

        // class Table{
        //     constructor(row,col,cell){
        //         this.row = row
        //         this.col = col
        //         this.cell = cell
        //     }

        //     render(){
        //         const table = document.createElement('table')
        //         const tbody = document.createElement('tbody')
        //         const row = document.createElement("tr")
        //         const cell = document.createElement("td")
        //         const cellText = document.createTextNode( `i can`)

        //         document.body.appendChild(table)
        //         table.setAttribute("border",2)
        //         table.appendChild(tbody)
        //         tbody.appendChild(row)
        //         row.appendChild(cell)
        //         cell.appendChild(cellText)

        //     }
        // }

        // let table = new Table(1,1,10)
        // table.render()


    </script>
    
</body>
</html>